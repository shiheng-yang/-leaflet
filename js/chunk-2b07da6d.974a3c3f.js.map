{"version":3,"sources":["webpack:///./src/views/leaflet2.vue","webpack:///src/views/leaflet2.vue","webpack:///./src/views/leaflet2.vue?e566","webpack:///./src/views/leaflet2.vue?eb67","webpack:///./public/home/bgc2.jpg","webpack:///./public/home/bgc1.jpg","webpack:///./public/home sync ^\\.\\/bgc.*\\.jpg$","webpack:///./public/home/bgc0.jpg","webpack:///./src/views/leaflet2.vue?af8a"],"names":["render","_vm","this","_c","_self","staticClass","_m","_v","attrs","on","initDate","model","value","pic","callback","$$v","expression","_l","picArr","item","index","key","name","id","staticRenderFns","DefaultIcon","L","iconUrl","icon","shadowUrl","iconShadow","prototype","options","data","map","fillColor","bounds","points","imageOverlay","methods","initMap","minZoom","zoom","maxZoom","zoomSnap","attributionControl","zoomControl","crs","Simple","center","pm","setLang","addControls","position","drawPolygon","drawMarker","drawCircleMarker","drawPolyline","drawRectangle","drawCircle","editMode","dragMode","cutPolygon","removalMode","setPathOptions","fillOpacity","eachLayer","layer","_latlngs","_latlng","remove","img","Image","url","require","src","onload","w","width","h","height","setUrl","setBounds","addTo","fitBounds","res","JSON","parse","localStorage","getItem","forEach","e","lay","latlngs","editLayClick","layClick","dragendLayClick","_leaflet_id","setItem","stringify","createClick","removeClick","dragging","disable","doubleClickZoom","scrollWheelZoom","obj","push","d","i","splice","console","log","target","mounted","window","onresize","invalidateSize","component","module","exports","webpackContext","req","webpackContextResolve","__webpack_require__","o","Error","code","keys","Object","resolve"],"mappings":"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","file":"js/chunk-2b07da6d.974a3c3f.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"box\"},[_vm._m(0),_c('div',{staticClass:\"select\"},[_c('span',[_vm._v(\"平面图：\")]),_c('el-select',{attrs:{\"placeholder\":\"全部\",\"clearable\":\"\",\"filterable\":\"\"},on:{\"change\":_vm.initDate},model:{value:(_vm.pic),callback:function ($$v) {_vm.pic=$$v},expression:\"pic\"}},_vm._l((_vm.picArr),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item.name,\"value\":item.id}})}),1)],1)])\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"imgBox\"},[_c('div',{attrs:{\"id\":\"imageMap\"}})])\n}]\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"box\">\n    <div class=\"imgBox\">\n      <div id=\"imageMap\"></div>\n    </div>\n    <div class=\"select\">\n      <span>平面图：</span>\n      <el-select v-model=\"pic\" placeholder=\"全部\" clearable filterable @change=\"initDate\">\n        <el-option :label=\"item.name\" v-for=\"(item, index) in picArr\" :key=\"index\" :value=\"item.id\"> </el-option>\n      </el-select>\n    </div>\n  </div>\n</template>\n<script>\nimport 'leaflet/dist/leaflet.css'\nimport 'leaflet/dist/leaflet'\nimport 'leaflet/dist/leaflet-src'\nimport 'leaflet/dist/leaflet-src.esm'\nimport * as L from 'leaflet'\nimport icon from 'leaflet/dist/images/marker-icon.png'\nimport iconShadow from 'leaflet/dist/images/marker-shadow.png'\nimport 'leaflet.pm'\nimport 'leaflet.pm/dist/leaflet.pm.css'\nconst DefaultIcon = L.icon({\n  iconUrl: icon,\n  shadowUrl: iconShadow,\n})\nL.Marker.prototype.options.icon = DefaultIcon\nexport default {\n  data() {\n    return {\n      map: null,\n      fillColor: '#2d75ff80',\n      bounds: [\n        [0, 0],\n        [0, 0],\n      ], // 平面图大小\n      pic: 0,\n      picArr: [\n        { id: 0, name: '1楼平面图', points: [] },\n        { id: 1, name: '2楼平面图', points: [] },\n        { id: 2, name: '3楼平面图', points: [] },\n      ],\n      imageOverlay: '',\n    }\n  },\n  methods: {\n    // 地图初始化\n    initMap() {\n      this.map = L.map('imageMap', {\n        minZoom: -3,\n        zoom: 5,\n        maxZoom: 4,\n        zoomSnap: 0.1, // 缩放步长\n        attributionControl: false, // 右下角图例控件\n        zoomControl: true, // 缩放控件\n        crs: L.CRS.Simple, // 坐标系\n        center: [0, 0], // 中心点\n      })\n      this.map.pm.setLang('zh') // 控件提示设置中文\n      this.map.pm.addControls({\n        position: 'topleft', // 控件菜单位置\n        drawPolygon: true, //绘制多边形\n        drawMarker: true, //绘制标记点\n        drawCircleMarker: true, //绘制圆形标记\n        drawPolyline: true, //绘制线条\n        drawRectangle: true, //绘制矩形\n        drawCircle: true, //绘制圆圈\n        editMode: true, //编辑多边形\n        dragMode: true, //拖动多边形\n        cutPolygon: true, //添加⼀个按钮以删除多边形⾥⾯的部分内容\n        removalMode: true, //清除多边形\n      })\n      // 全局图层样式\n      this.map.pm.setPathOptions({\n        fillOpacity: 0.5,\n        fillColor: this.fillColor,\n      })\n    },\n    // 平面图初始化\n    initDate() {\n      // 循环遍历图层删除\n      this.map.eachLayer((layer) => {\n        if (layer._latlngs != null || layer._latlng != null) {\n          layer.remove()\n        }\n      })\n      // 获取图片宽高,防止不同尺寸的图片回显在页面上有多余的留白问题\n      let img = new Image()\n      let url = require(`../../public/home/bgc${this.pic}.jpg`)\n      img.src = url\n      img.onload = () => {\n        let w = img.width\n        let h = img.height\n        this.bounds = [\n          [0, 0],\n          [h, w],\n        ]\n        // 添加图片,更换图片\n        if (this.imageOverlay) {\n          this.imageOverlay.setUrl(url)\n          this.imageOverlay.setBounds(this.bounds)\n        } else {\n          this.imageOverlay = L.imageOverlay(url, this.bounds).addTo(this.map)\n        }\n        // 设置地图图层区域\n        this.map.fitBounds(this.bounds)\n      }\n      // 获取本地存储的图层数据\n      let res = JSON.parse(localStorage.getItem('layers')) || []\n      if (res[this.pic]) {\n        // 循环绘制图层\n        res[this.pic].forEach((e) => {\n          let lay = L.polygon(e.latlngs).addTo(this.map).on('pm:edit', this.editLayClick).on('click', this.layClick).on('pm:dragend', this.dragendLayClick)\n          e._leaflet_id = lay._leaflet_id\n        })\n        localStorage.setItem('layers', JSON.stringify(res))\n      }\n      // 给地图绑定绘制、删除的事件\n      this.map.on('pm:create', this.createClick)\n      this.map.on('pm:remove', this.removeClick)\n      // 禁止背景图拖拽,默认是可拖拽的\n      this.map.dragging.disable()\n      // 禁止双击缩放,默认是可双击缩放的\n      this.map.doubleClickZoom.disable()\n      // 禁止滚动缩放,默认是可滚动缩放的\n      this.map.scrollWheelZoom.disable()\n    },\n    // 图层绘制完成\n    createClick(e) {\n      // console.log('图层绘制完成', e)\n      // 获取缓存的图层数据\n      let res = JSON.parse(localStorage.getItem('layers')) || []\n      if (!res[this.pic]) res[this.pic] = []\n      let obj = {\n        _leaflet_id: e.layer._leaflet_id,\n        latlngs: e.layer._latlngs,\n      }\n      res[this.pic].push(obj)\n      localStorage.setItem('layers', JSON.stringify(res))\n      // 给图层绑定点击、拖拽、编辑事件\n      e.layer.on('pm:edit', this.editLayClick).on('click', this.layClick).on('pm:dragend', this.dragendLayClick)\n    },\n    // 图层删除\n    removeClick(e) {\n      // console.log('图层删除', e)\n      let res = JSON.parse(localStorage.getItem('layers')) || []\n      res[this.pic].forEach((d, i) => {\n        if (d._leaflet_id == e.layer._leaflet_id) {\n          res[this.pic].splice(i, 1)\n        }\n      })\n      localStorage.setItem('layers', JSON.stringify(res))\n    },\n    // 区域图层点击\n    layClick(e) {\n      // console.log('区域图层点击', e)\n    },\n    // 区域图层拖拽\n    dragendLayClick(e) {\n      console.log('区域图层拖拽', e)\n    },\n    // 区域图层编辑\n    editLayClick(e) {\n      console.log('图层编辑', e)\n      let res = JSON.parse(localStorage.getItem('layers'))\n      res[this.pic].forEach((d) => {\n        if (d._leaflet_id == e.target._leaflet_id) {\n          d.latlngs = e.target._latlngs\n          d._leaflet_id = e.target._leaflet_id\n          d.options = e.target.options\n        }\n      })\n      localStorage.setItem('layers', JSON.stringify(res))\n    },\n  },\n  mounted() {\n    this.initMap()\n    this.initDate()\n    // 窗口缩放,地图自适应缩放\n    window.onresize = () => {\n      this.map.invalidateSize(true)\n      this.map.fitBounds(this.bounds)\n    }\n  },\n}\n</script>\n<style lang=\"less\" scoped>\n.box {\n  width: 100%;\n  height: 100%;\n  display: flex;\n}\n.imgBox {\n  width: 50%;\n  height: 100%;\n  padding: 0 10px;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n  box-sizing: border-box;\n  #imageMap {\n    height: 100%;\n    box-sizing: border-box;\n  }\n}\n.leaflet-container {\n  font-size: 0.2rem;\n  background: #fff;\n}\n.select {\n  font-size: initial;\n  margin-left: 10px;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./leaflet2.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./leaflet2.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./leaflet2.vue?vue&type=template&id=3cd1766e&scoped=true\"\nimport script from \"./leaflet2.vue?vue&type=script&lang=js\"\nexport * from \"./leaflet2.vue?vue&type=script&lang=js\"\nimport style0 from \"./leaflet2.vue?vue&type=style&index=0&id=3cd1766e&prod&lang=less&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3cd1766e\",\n  null\n  \n)\n\nexport default component.exports","module.exports = __webpack_public_path__ + \"img/bgc2.399a34d2.jpg\";","module.exports = __webpack_public_path__ + \"img/bgc1.6b56c0bd.jpg\";","var map = {\n\t\"./bgc0.jpg\": \"6c8e\",\n\t\"./bgc1.jpg\": \"2de9\",\n\t\"./bgc2.jpg\": \"2cba\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"588d\";","module.exports = __webpack_public_path__ + \"img/bgc0.8cba642e.jpg\";","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./leaflet2.vue?vue&type=style&index=0&id=3cd1766e&prod&lang=less&scoped=true\""],"sourceRoot":""}